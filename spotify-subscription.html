<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Subscription Dashboard</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap"
        rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --spotify-green: #1DB954;
            --spotify-green-hover: #1ed760;
            --spotify-black: #191414;
            --spotify-dark: #121212;
            --spotify-gray: #282828;
            --spotify-light-gray: #B3B3B3;
            --spotify-white: #FFFFFF;
            --spotify-red: #E22134;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(180deg, var(--spotify-black) 0%, var(--spotify-dark) 100%);
            color: var(--spotify-white);
            min-height: 100vh;
            padding-bottom: 2rem;
        }

        /* Header */
        .header {
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(10px);
            padding: 1rem 2rem;
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }

        .header-content {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-size: 1.5rem;
            font-weight: 900;
            color: var(--spotify-green);
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .header-controls {
            display: flex;
            gap: 0.75rem;
            align-items: center;
        }

        .btn-icon {
            background: var(--spotify-gray);
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s;
            color: var(--spotify-white);
            font-size: 1.2rem;
        }

        .btn-icon:hover {
            background: var(--spotify-light-gray);
            transform: scale(1.05);
        }

        /* Container */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* Hero Section */
        .hero {
            background: linear-gradient(135deg, var(--spotify-gray) 0%, var(--spotify-dark) 100%);
            border-radius: 16px;
            padding: 3rem 2rem;
            text-align: center;
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at top right, rgba(29, 185, 84, 0.2), transparent 50%);
            pointer-events: none;
        }

        .hero-content {
            position: relative;
            z-index: 1;
        }

        .user-avatar {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--spotify-green), #1ed760);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
            margin: 0 auto 1.5rem;
            box-shadow: 0 8px 24px rgba(29, 185, 84, 0.3);
        }

        .username {
            font-size: 3rem;
            font-weight: 900;
            margin-bottom: 0.5rem;
            text-transform: capitalize;
        }

        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1.5rem;
            border-radius: 99px;
            font-weight: 600;
            font-size: 0.9rem;
            margin-bottom: 2rem;
        }

        .status-badge.active {
            background: rgba(29, 185, 84, 0.2);
            color: var(--spotify-green);
        }

        .status-badge.expired {
            background: rgba(226, 33, 52, 0.2);
            color: var(--spotify-red);
        }

        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: currentColor;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.5;
            }
        }

        .hero-actions {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn {
            padding: 0.875rem 2rem;
            border-radius: 99px;
            border: none;
            font-weight: 700;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-primary {
            background: var(--spotify-green);
            color: var(--spotify-black);
        }

        .btn-primary:hover {
            background: var(--spotify-green-hover);
            transform: scale(1.05);
        }

        .btn-secondary {
            background: transparent;
            color: var(--spotify-white);
            border: 2px solid var(--spotify-white);
        }

        .btn-secondary:hover {
            background: var(--spotify-white);
            color: var(--spotify-black);
        }

        /* Stats Grid */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .stat-card {
            background: var(--spotify-gray);
            border-radius: 12px;
            padding: 1.5rem;
            transition: all 0.3s;
        }

        .stat-card:hover {
            background: #2a2a2a;
            transform: translateY(-4px);
        }

        .stat-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1rem;
        }

        .stat-icon {
            font-size: 2rem;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 900;
            margin-bottom: 0.25rem;
        }

        .stat-label {
            color: var(--spotify-light-gray);
            font-size: 0.875rem;
            font-weight: 500;
        }

        .stat-total {
            color: var(--spotify-light-gray);
            font-size: 0.875rem;
            margin-top: 0.25rem;
        }

        .progress-bar {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 99px;
            overflow: hidden;
            margin-top: 1rem;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--spotify-green), var(--spotify-green-hover));
            border-radius: 99px;
            transition: width 1s ease;
        }

        /* Filters */
        .filters {
            background: var(--spotify-gray);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 2rem;
        }

        .filter-section {
            margin-bottom: 1rem;
        }

        .filter-section:last-child {
            margin-bottom: 0;
        }

        .filter-label {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--spotify-light-gray);
            margin-bottom: 0.75rem;
            display: block;
        }

        .filter-chips {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .chip {
            padding: 0.5rem 1rem;
            border-radius: 99px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid transparent;
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 500;
            transition: all 0.2s;
        }

        .chip:hover {
            background: rgba(255, 255, 255, 0.15);
        }

        .chip.active {
            background: var(--spotify-green);
            color: var(--spotify-black);
            border-color: var(--spotify-green);
        }

        /* Server List */
        .servers-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
        }

        .servers-title {
            font-size: 1.5rem;
            font-weight: 900;
        }

        .server-count {
            color: var(--spotify-light-gray);
            font-size: 0.875rem;
        }

        .servers-grid {
            display: grid;
            gap: 1rem;
        }

        .server-card {
            background: var(--spotify-gray);
            border-radius: 12px;
            padding: 1.5rem;
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .server-card:hover {
            background: #2a2a2a;
            border-color: var(--spotify-green);
            transform: translateX(4px);
        }

        .server-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .server-flag {
            font-size: 2rem;
        }

        .server-info {
            flex: 1;
        }

        .server-name {
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 0.25rem;
        }

        .server-meta {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .badge {
            padding: 0.25rem 0.75rem;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
            background: rgba(29, 185, 84, 0.2);
            color: var(--spotify-green);
        }

        .badge.protocol {
            background: rgba(59, 130, 246, 0.2);
            color: #3b82f6;
        }

        .server-actions {
            display: flex;
            gap: 0.5rem;
        }

        .btn-small {
            padding: 0.5rem 1rem;
            border-radius: 8px;
            border: none;
            background: rgba(255, 255, 255, 0.1);
            color: var(--spotify-white);
            cursor: pointer;
            font-size: 0.875rem;
            font-weight: 600;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .btn-small:hover {
            background: var(--spotify-green);
            color: var(--spotify-black);
        }

        /* Quick Actions */
        .quick-actions {
            background: var(--spotify-gray);
            border-radius: 12px;
            padding: 2rem;
            margin-top: 2rem;
        }

        .quick-actions-title {
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 1.5rem;
        }

        .quick-actions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .quick-action-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .quick-action-btn:hover {
            background: rgba(29, 185, 84, 0.1);
            border-color: var(--spotify-green);
            transform: translateY(-4px);
        }

        .quick-action-icon {
            font-size: 2.5rem;
            margin-bottom: 0.75rem;
        }

        .quick-action-label {
            font-weight: 600;
            font-size: 0.95rem;
        }

        /* Footer */
        .footer {
            text-align: center;
            padding: 2rem;
            color: var(--spotify-light-gray);
            font-size: 0.875rem;
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            background: var(--spotify-green);
            color: var(--spotify-black);
            padding: 1rem 1.5rem;
            border-radius: 8px;
            font-weight: 600;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
            transform: translateY(100px);
            opacity: 0;
            transition: all 0.3s;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .toast.show {
            transform: translateY(0);
            opacity: 1;
        }

        /* Loading */
        .loading {
            text-align: center;
            padding: 4rem 2rem;
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-top-color: var(--spotify-green);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 1rem;
            }

            .header {
                padding: 1rem;
            }

            .hero {
                padding: 2rem 1rem;
            }

            .username {
                font-size: 2rem;
            }

            .user-avatar {
                width: 80px;
                height: 80px;
                font-size: 2rem;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            .hero-actions {
                flex-direction: column;
            }

            .btn {
                width: 100%;
                justify-content: center;
            }
        }

        /* RTL Support */
        [dir="rtl"] {
            font-family: 'Vazirmatn', 'Inter', sans-serif;
        }

        [dir="rtl"] .server-card:hover {
            transform: translateX(-4px);
        }

        /* Section Styles */
        .section {
            background: var(--spotify-gray);
            border-radius: 16px;
            padding: 2rem;
            margin-top: 2rem;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 900;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .section-title i {
            color: var(--spotify-green);
            font-size: 1.75rem;
        }

        .section-desc {
            color: var(--spotify-light-gray);
            margin-bottom: 2rem;
        }

        /* Apps Section */
        .apps-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1.5rem;
        }

        .app-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .app-card:hover {
            background: rgba(29, 185, 84, 0.1);
            border-color: var(--spotify-green);
            transform: translateY(-4px);
        }

        .app-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .app-name {
            font-size: 1.25rem;
            font-weight: 700;
            margin-bottom: 1rem;
        }

        .app-links {
            display: flex;
            flex-direction: column;
            gap: 0.5rem;
        }

        .app-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.75rem 1rem;
            background: var(--spotify-green);
            color: var(--spotify-black);
            text-decoration: none;
            border-radius: 8px;
            font-weight: 600;
            font-size: 0.9rem;
            transition: all 0.2s;
        }

        .app-btn:hover {
            background: var(--spotify-green-hover);
            transform: scale(1.02);
        }

        .app-btn.secondary {
            background: rgba(255, 255, 255, 0.1);
            color: var(--spotify-white);
        }

        .app-btn.secondary:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        /* Tutorial Section */
        .tutorial-steps {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .tutorial-step {
            display: flex;
            gap: 1.5rem;
            align-items: flex-start;
            padding: 1.5rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            transition: all 0.3s;
        }

        .tutorial-step:hover {
            background: rgba(29, 185, 84, 0.1);
            transform: translateX(4px);
        }

        .step-number {
            width: 48px;
            height: 48px;
            background: var(--spotify-green);
            color: var(--spotify-black);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
            font-weight: 900;
            flex-shrink: 0;
        }

        .step-content h4 {
            font-size: 1.1rem;
            margin-bottom: 0.5rem;
        }

        .step-content p {
            color: var(--spotify-light-gray);
            font-size: 0.95rem;
        }

        /* FAQ Section */
        .faq-list {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .faq-item {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            overflow: hidden;
            cursor: pointer;
            transition: all 0.3s;
        }

        .faq-item:hover {
            background: rgba(255, 255, 255, 0.08);
        }

        .faq-item.open {
            background: rgba(29, 185, 84, 0.1);
        }

        .faq-question {
            padding: 1.25rem 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 600;
        }

        .faq-question i {
            transition: transform 0.3s;
            font-size: 1.25rem;
        }

        .faq-item.open .faq-question i {
            transform: rotate(180deg);
        }

        .faq-answer {
            padding: 0 1.5rem 1.5rem;
            color: var(--spotify-light-gray);
            line-height: 1.6;
            display: none;
        }

        .faq-item.open .faq-answer {
            display: block;
        }

        /* Support Section */
        .support-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
        }

        .support-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 2rem;
            text-align: center;
            text-decoration: none;
            color: var(--spotify-white);
            transition: all 0.3s;
            border: 2px solid transparent;
        }

        .support-card:hover {
            background: rgba(29, 185, 84, 0.1);
            border-color: var(--spotify-green);
            transform: translateY(-4px);
        }

        .support-icon {
            width: 64px;
            height: 64px;
            background: var(--spotify-green);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 1rem;
        }

        .support-icon i {
            font-size: 1.75rem;
            color: var(--spotify-black);
        }

        .support-card h4 {
            font-size: 1.25rem;
            margin-bottom: 0.5rem;
        }

        .support-card p {
            color: var(--spotify-light-gray);
            font-size: 0.9rem;
        }

        /* Mobile Responsive for new sections */
        @media (max-width: 768px) {
            .section {
                padding: 1.5rem;
            }

            .tutorial-step {
                flex-direction: column;
                text-align: center;
            }

            .step-number {
                margin: 0 auto;
            }

            .app-card {
                padding: 1rem;
            }
        }

        [dir="rtl"] .tutorial-step:hover {
            transform: translateX(-4px);
        }
    </style>
</head>

<body>
    <!-- Header -->
    <header class="header">
        <div class="header-content">
            <div class="logo">
                <i class="ri-music-2-fill"></i>
                <span>Subscription</span>
            </div>
            <div class="header-controls">
                <button class="btn-icon" onclick="toggleLanguage()" title="Language">
                    <span id="lang-icon">EN</span>
                </button>
                <button class="btn-icon" onclick="window.location.reload()" title="Refresh">
                    <i class="ri-refresh-line"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- Main Container -->
    <div class="container">
        <!-- Loading State -->
        <div id="loading" class="loading">
            <div class="spinner"></div>
            <p>Loading subscription data...</p>
        </div>

        <!-- Content (Hidden initially) -->
        <div id="content" style="display: none;">
            <!-- Hero Section -->
            <div class="hero">
                <div class="hero-content">
                    <div class="user-avatar">
                        <i class="ri-user-smile-fill"></i>
                    </div>
                    <h1 class="username" id="username">User</h1>
                    <div class="status-badge active" id="status-badge">
                        <div class="status-dot"></div>
                        <span id="status-text">Active</span>
                    </div>
                    <div class="hero-actions">
                        <button class="btn btn-primary" onclick="copyAllConfigs()">
                            <i class="ri-file-copy-line"></i>
                            <span data-i18n="copyAll">Copy All Configs</span>
                        </button>
                        <button class="btn btn-secondary" onclick="downloadQR()">
                            <i class="ri-qr-code-line"></i>
                            <span data-i18n="downloadQR">Download QR</span>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Stats Grid -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon">üìä</div>
                    </div>
                    <div class="stat-value" id="used-traffic">0 GB</div>
                    <div class="stat-label" data-i18n="used">Used</div>
                    <div class="stat-total">of <span id="total-traffic">0 GB</span></div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="traffic-progress" style="width: 0%"></div>
                    </div>
                </div>

                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon">üìÖ</div>
                    </div>
                    <div class="stat-value" id="expire-date">-</div>
                    <div class="stat-label" data-i18n="expires">Expires</div>
                </div>

                <div class="stat-card">
                    <div class="stat-header">
                        <div class="stat-icon">‚è∞</div>
                    </div>
                    <div class="stat-value" id="days-left">-</div>
                    <div class="stat-label" data-i18n="daysLeft">Days Left</div>
                </div>
            </div>

            <!-- Filters -->
            <div class="filters">
                <div class="filter-section">
                    <span class="filter-label" data-i18n="filterCountry">Filter by Country</span>
                    <div class="filter-chips" id="country-filters"></div>
                </div>
                <div class="filter-section">
                    <span class="filter-label" data-i18n="filterProtocol">Filter by Protocol</span>
                    <div class="filter-chips" id="protocol-filters"></div>
                </div>
            </div>

            <!-- Server List -->
            <div class="servers-header">
                <h2 class="servers-title" data-i18n="servers">Servers</h2>
                <span class="server-count"><span id="server-count">0</span> <span
                        data-i18n="available">available</span></span>
            </div>
            <div class="servers-grid" id="servers-list"></div>

            <!-- Quick Actions -->
            <div class="quick-actions">
                <h3 class="quick-actions-title" data-i18n="quickActions">Quick Actions</h3>
                <div class="quick-actions-grid">
                    <div class="quick-action-btn" onclick="importAll()">
                        <div class="quick-action-icon">üì±</div>
                        <div class="quick-action-label" data-i18n="importAll">Import All</div>
                    </div>
                    <div class="quick-action-btn" onclick="downloadAll()">
                        <div class="quick-action-icon">üíæ</div>
                        <div class="quick-action-label" data-i18n="downloadAll">Download All</div>
                    </div>
                    <div class="quick-action-btn" onclick="testSpeed()">
                        <div class="quick-action-icon">üìä</div>
                        <div class="quick-action-label" data-i18n="testSpeed">Test Speed</div>
                    </div>
                    <div class="quick-action-btn" onclick="getSupport()">
                        <div class="quick-action-icon">üìû</div>
                        <div class="quick-action-label" data-i18n="support">Support</div>
                    </div>
                </div>
            </div>

            <!-- Download Apps Section -->
            <div class="section apps-section" id="apps-section">
                <h2 class="section-title">
                    <i class="ri-download-cloud-2-line"></i>
                    <span data-i18n="downloadApps">Download Apps</span>
                </h2>
                <p class="section-desc" data-i18n="downloadAppsDesc">Choose your platform to download the VPN client</p>

                <div class="apps-grid">
                    <!-- Android -->
                    <div class="app-card">
                        <div class="app-icon">ü§ñ</div>
                        <h3 class="app-name">Android</h3>
                        <div class="app-links">
                            <a href="https://play.google.com/store/apps/details?id=com.v2ray.ang" target="_blank"
                                class="app-btn">
                                <i class="ri-google-play-fill"></i> v2rayNG
                            </a>
                            <a href="https://play.google.com/store/apps/details?id=com.github.nicls.xray.neko"
                                target="_blank" class="app-btn secondary">
                                <i class="ri-android-fill"></i> NekoBox
                            </a>
                        </div>
                    </div>

                    <!-- iOS -->
                    <div class="app-card">
                        <div class="app-icon">üçé</div>
                        <h3 class="app-name">iOS / iPadOS</h3>
                        <div class="app-links">
                            <a href="https://apps.apple.com/app/shadowrocket/id932747118" target="_blank"
                                class="app-btn">
                                <i class="ri-apple-fill"></i> Shadowrocket
                            </a>
                            <a href="https://apps.apple.com/app/streisand/id6450534064" target="_blank"
                                class="app-btn secondary">
                                <i class="ri-apple-fill"></i> Streisand
                            </a>
                        </div>
                    </div>

                    <!-- Windows -->
                    <div class="app-card">
                        <div class="app-icon">ü™ü</div>
                        <h3 class="app-name">Windows</h3>
                        <div class="app-links">
                            <a href="https://github.com/2dust/v2rayN/releases" target="_blank" class="app-btn">
                                <i class="ri-windows-fill"></i> v2rayN
                            </a>
                            <a href="https://github.com/MatsuriDayo/nekoray/releases" target="_blank"
                                class="app-btn secondary">
                                <i class="ri-windows-fill"></i> Nekoray
                            </a>
                        </div>
                    </div>

                    <!-- macOS -->
                    <div class="app-card">
                        <div class="app-icon">üíª</div>
                        <h3 class="app-name">macOS</h3>
                        <div class="app-links">
                            <a href="https://github.com/yanue/V2rayU/releases" target="_blank" class="app-btn">
                                <i class="ri-apple-fill"></i> V2rayU
                            </a>
                            <a href="https://github.com/MatsuriDayo/nekoray/releases" target="_blank"
                                class="app-btn secondary">
                                <i class="ri-apple-fill"></i> Nekoray
                            </a>
                        </div>
                    </div>

                    <!-- Linux -->
                    <div class="app-card">
                        <div class="app-icon">üêß</div>
                        <h3 class="app-name">Linux</h3>
                        <div class="app-links">
                            <a href="https://github.com/MatsuriDayo/nekoray/releases" target="_blank" class="app-btn">
                                <i class="ri-ubuntu-fill"></i> Nekoray
                            </a>
                            <a href="https://github.com/niclis/v2rayA/releases" target="_blank"
                                class="app-btn secondary">
                                <i class="ri-terminal-box-fill"></i> v2rayA
                            </a>
                        </div>
                    </div>

                    <!-- Router -->
                    <div class="app-card">
                        <div class="app-icon">üì°</div>
                        <h3 class="app-name">Router</h3>
                        <div class="app-links">
                            <a href="https://github.com/vernesong/OpenClash/releases" target="_blank" class="app-btn">
                                <i class="ri-router-fill"></i> OpenClash
                            </a>
                            <a href="https://github.com/fw876/helloworld" target="_blank" class="app-btn secondary">
                                <i class="ri-router-fill"></i> Passwall
                            </a>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Tutorial Section -->
            <div class="section tutorial-section" id="tutorial-section">
                <h2 class="section-title">
                    <i class="ri-book-open-line"></i>
                    <span data-i18n="tutorial">How to Use</span>
                </h2>
                <p class="section-desc" data-i18n="tutorialDesc">Follow these simple steps to connect</p>

                <div class="tutorial-steps">
                    <div class="tutorial-step">
                        <div class="step-number">1</div>
                        <div class="step-content">
                            <h4 data-i18n="step1Title">Download the App</h4>
                            <p data-i18n="step1Desc">Choose and install the appropriate app for your device from the
                                list above.</p>
                        </div>
                    </div>
                    <div class="tutorial-step">
                        <div class="step-number">2</div>
                        <div class="step-content">
                            <h4 data-i18n="step2Title">Copy Subscription Link</h4>
                            <p data-i18n="step2Desc">Click "Copy All Configs" button at the top of this page.</p>
                        </div>
                    </div>
                    <div class="tutorial-step">
                        <div class="step-number">3</div>
                        <div class="step-content">
                            <h4 data-i18n="step3Title">Import in App</h4>
                            <p data-i18n="step3Desc">Open your VPN app and paste the subscription link to import all
                                servers.</p>
                        </div>
                    </div>
                    <div class="tutorial-step">
                        <div class="step-number">4</div>
                        <div class="step-content">
                            <h4 data-i18n="step4Title">Connect & Enjoy</h4>
                            <p data-i18n="step4Desc">Select a server and tap connect. You're all set!</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- FAQ Section -->
            <div class="section faq-section" id="faq-section">
                <h2 class="section-title">
                    <i class="ri-question-answer-line"></i>
                    <span data-i18n="faq">Frequently Asked Questions</span>
                </h2>

                <div class="faq-list">
                    <div class="faq-item" onclick="toggleFaq(this)">
                        <div class="faq-question">
                            <span data-i18n="faq1Q">What is a subscription link?</span>
                            <i class="ri-arrow-down-s-line"></i>
                        </div>
                        <div class="faq-answer" data-i18n="faq1A">
                            A subscription link contains all your server configurations. When you add it to a VPN app,
                            it automatically downloads and updates all available servers.
                        </div>
                    </div>

                    <div class="faq-item" onclick="toggleFaq(this)">
                        <div class="faq-question">
                            <span data-i18n="faq2Q">How do I update servers?</span>
                            <i class="ri-arrow-down-s-line"></i>
                        </div>
                        <div class="faq-answer" data-i18n="faq2A">
                            Most apps have an "Update Subscription" button. Click it to refresh your server list with
                            the latest configurations.
                        </div>
                    </div>

                    <div class="faq-item" onclick="toggleFaq(this)">
                        <div class="faq-question">
                            <span data-i18n="faq3Q">Which server should I choose?</span>
                            <i class="ri-arrow-down-s-line"></i>
                        </div>
                        <div class="faq-answer" data-i18n="faq3A">
                            Choose a server closest to your location for better speed. If one server doesn't work, try
                            another. Servers with "Reality" or "TLS" are more stable.
                        </div>
                    </div>

                    <div class="faq-item" onclick="toggleFaq(this)">
                        <div class="faq-question">
                            <span data-i18n="faq4Q">What if I can't connect?</span>
                            <i class="ri-arrow-down-s-line"></i>
                        </div>
                        <div class="faq-answer" data-i18n="faq4A">
                            Try these steps: 1) Switch to a different server, 2) Update your subscription, 3) Restart
                            the app, 4) Check your internet connection. If still not working, contact support.
                        </div>
                    </div>

                    <div class="faq-item" onclick="toggleFaq(this)">
                        <div class="faq-question">
                            <span data-i18n="faq5Q">How much data can I use?</span>
                            <i class="ri-arrow-down-s-line"></i>
                        </div>
                        <div class="faq-answer" data-i18n="faq5A">
                            Your data limit is shown in the "Used" stat card above. Once you reach your limit, your
                            connection will be paused until renewal.
                        </div>
                    </div>
                </div>
            </div>

            <!-- Support Section -->
            <div class="section support-section" id="support-section">
                <h2 class="section-title">
                    <i class="ri-customer-service-2-line"></i>
                    <span data-i18n="supportTitle">Need Help?</span>
                </h2>
                <p class="section-desc" data-i18n="supportDesc">We're here to help you 24/7</p>

                <div class="support-grid">
                    <a href="https://t.me/support" target="_blank" class="support-card">
                        <div class="support-icon">
                            <i class="ri-telegram-fill"></i>
                        </div>
                        <h4>Telegram</h4>
                        <p data-i18n="telegramDesc">Fast response via Telegram</p>
                    </a>

                    <a href="mailto:support@example.com" class="support-card">
                        <div class="support-icon">
                            <i class="ri-mail-fill"></i>
                        </div>
                        <h4>Email</h4>
                        <p data-i18n="emailDesc">Send us an email</p>
                    </a>

                    <a href="#" onclick="showTicketForm(); return false;" class="support-card">
                        <div class="support-icon">
                            <i class="ri-customer-service-fill"></i>
                        </div>
                        <h4 data-i18n="ticketTitle">Submit Ticket</h4>
                        <p data-i18n="ticketDesc">Create a support ticket</p>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <p>¬© 2025 ‚Ä¢ Powered by Marzban</p>
    </footer>

    <!-- Toast -->
    <div class="toast" id="toast">
        <i class="ri-checkbox-circle-fill"></i>
        <span id="toast-message">Success!</span>
    </div>

    <!-- QR Code Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

    <script>
        // Translations
        const translations = {
            en: {
                active: "Active",
                expired: "Expired",
                used: "Used",
                expires: "Expires",
                daysLeft: "Days Left",
                copyAll: "Copy All Configs",
                downloadQR: "Download QR",
                filterCountry: "Filter by Country",
                filterProtocol: "Filter by Protocol",
                servers: "Servers",
                available: "available",
                quickActions: "Quick Actions",
                importAll: "Import All",
                downloadAll: "Download All",
                testSpeed: "Test Speed",
                support: "Support",
                copy: "Copy",
                qr: "QR",
                import: "Import",
                copied: "Copied to clipboard!",
                all: "All",
                // New sections
                downloadApps: "Download Apps",
                downloadAppsDesc: "Choose your platform to download the VPN client",
                tutorial: "How to Use",
                tutorialDesc: "Follow these simple steps to connect",
                step1Title: "Download the App",
                step1Desc: "Choose and install the appropriate app for your device from the list above.",
                step2Title: "Copy Subscription Link",
                step2Desc: "Click \"Copy All Configs\" button at the top of this page.",
                step3Title: "Import in App",
                step3Desc: "Open your VPN app and paste the subscription link to import all servers.",
                step4Title: "Connect & Enjoy",
                step4Desc: "Select a server and tap connect. You're all set!",
                faq: "Frequently Asked Questions",
                faq1Q: "What is a subscription link?",
                faq1A: "A subscription link contains all your server configurations. When you add it to a VPN app, it automatically downloads and updates all available servers.",
                faq2Q: "How do I update servers?",
                faq2A: "Most apps have an \"Update Subscription\" button. Click it to refresh your server list with the latest configurations.",
                faq3Q: "Which server should I choose?",
                faq3A: "Choose a server closest to your location for better speed. If one server doesn't work, try another. Servers with \"Reality\" or \"TLS\" are more stable.",
                faq4Q: "What if I can't connect?",
                faq4A: "Try these steps: 1) Switch to a different server, 2) Update your subscription, 3) Restart the app, 4) Check your internet connection.",
                faq5Q: "How much data can I use?",
                faq5A: "Your data limit is shown in the \"Used\" stat card above. Once you reach your limit, your connection will be paused until renewal.",
                supportTitle: "Need Help?",
                supportDesc: "We're here to help you 24/7",
                telegramDesc: "Fast response via Telegram",
                emailDesc: "Send us an email",
                ticketTitle: "Submit Ticket",
                ticketDesc: "Create a support ticket"
            },
            fa: {
                active: "ŸÅÿπÿßŸÑ",
                expired: "ŸÖŸÜŸÇÿ∂€å ÿ¥ÿØŸá",
                used: "ŸÖÿµÿ±ŸÅ ÿ¥ÿØŸá",
                expires: "ÿ™ÿßÿ±€åÿÆ ÿßŸÜŸÇÿ∂ÿß",
                daysLeft: "ÿ±Ÿàÿ≤ ÿ®ÿßŸÇ€åŸÖÿßŸÜÿØŸá",
                copyAll: "⁄©Ÿæ€å ŸáŸÖŸá ⁄©ÿßŸÜŸÅ€å⁄Ø‚ÄåŸáÿß",
                downloadQR: "ÿØÿßŸÜŸÑŸàÿØ QR",
                filterCountry: "ŸÅ€åŸÑÿ™ÿ± ÿ®ÿ± ÿßÿ≥ÿßÿ≥ ⁄©ÿ¥Ÿàÿ±",
                filterProtocol: "ŸÅ€åŸÑÿ™ÿ± ÿ®ÿ± ÿßÿ≥ÿßÿ≥ Ÿæÿ±Ÿàÿ™⁄©ŸÑ",
                servers: "ÿ≥ÿ±Ÿàÿ±Ÿáÿß",
                available: "ŸÖŸàÿ¨ŸàÿØ",
                quickActions: "ÿßŸÇÿØÿßŸÖÿßÿ™ ÿ≥ÿ±€åÿπ",
                importAll: "ÿß€åŸÖŸæŸàÿ±ÿ™ ŸáŸÖŸá",
                downloadAll: "ÿØÿßŸÜŸÑŸàÿØ ŸáŸÖŸá",
                testSpeed: "ÿ™ÿ≥ÿ™ ÿ≥ÿ±ÿπÿ™",
                support: "Ÿæÿ¥ÿ™€åÿ®ÿßŸÜ€å",
                copy: "⁄©Ÿæ€å",
                qr: "QR",
                import: "ÿß€åŸÖŸæŸàÿ±ÿ™",
                copied: "⁄©Ÿæ€å ÿ¥ÿØ!",
                all: "ŸáŸÖŸá",
                // New sections
                downloadApps: "ÿØÿßŸÜŸÑŸàÿØ ÿ®ÿ±ŸÜÿßŸÖŸá‚ÄåŸáÿß",
                downloadAppsDesc: "ÿ®ÿ±ŸÜÿßŸÖŸá ŸÖŸÜÿßÿ≥ÿ® ÿØÿ≥ÿ™⁄ØÿßŸá ÿÆŸàÿØ ÿ±ÿß ÿßŸÜÿ™ÿÆÿßÿ® ⁄©ŸÜ€åÿØ",
                tutorial: "ŸÜÿ≠ŸàŸá ÿßÿ≥ÿ™ŸÅÿßÿØŸá",
                tutorialDesc: "ŸÖÿ±ÿßÿ≠ŸÑ ÿ≥ÿßÿØŸá ÿßÿ™ÿµÿßŸÑ ÿ±ÿß ÿØŸÜÿ®ÿßŸÑ ⁄©ŸÜ€åÿØ",
                step1Title: "ÿØÿßŸÜŸÑŸàÿØ ÿ®ÿ±ŸÜÿßŸÖŸá",
                step1Desc: "ÿ®ÿ±ŸÜÿßŸÖŸá ŸÖŸÜÿßÿ≥ÿ® ÿØÿ≥ÿ™⁄ØÿßŸá ÿÆŸàÿØ ÿ±ÿß ÿßÿ≤ ŸÑ€åÿ≥ÿ™ ÿ®ÿßŸÑÿß ÿØÿßŸÜŸÑŸàÿØ ⁄©ŸÜ€åÿØ.",
                step2Title: "⁄©Ÿæ€å ŸÑ€åŸÜ⁄© ÿßÿ¥ÿ™ÿ±ÿß⁄©",
                step2Desc: "ÿØ⁄©ŸÖŸá ¬´⁄©Ÿæ€å ŸáŸÖŸá ⁄©ÿßŸÜŸÅ€å⁄Ø‚ÄåŸáÿß¬ª ÿ±ÿß ÿØÿ± ÿ®ÿßŸÑÿß€å ÿµŸÅÿ≠Ÿá ⁄©ŸÑ€å⁄© ⁄©ŸÜ€åÿØ.",
                step3Title: "ÿß€åŸÖŸæŸàÿ±ÿ™ ÿØÿ± ÿ®ÿ±ŸÜÿßŸÖŸá",
                step3Desc: "ÿ®ÿ±ŸÜÿßŸÖŸá VPN ÿ±ÿß ÿ®ÿßÿ≤ ⁄©ŸÜ€åÿØ Ÿà ŸÑ€åŸÜ⁄© ÿßÿ¥ÿ™ÿ±ÿß⁄© ÿ±ÿß paste ⁄©ŸÜ€åÿØ.",
                step4Title: "ÿßÿ™ÿµÿßŸÑ Ÿà ŸÑÿ∞ÿ™ ÿ®ÿ®ÿ±€åÿØ",
                step4Desc: "€å⁄© ÿ≥ÿ±Ÿàÿ± ÿßŸÜÿ™ÿÆÿßÿ® ⁄©ŸÜ€åÿØ Ÿà ŸÖÿ™ÿµŸÑ ÿ¥Ÿà€åÿØ!",
                faq: "ÿ≥ŸàÿßŸÑÿßÿ™ ŸÖÿ™ÿØÿßŸàŸÑ",
                faq1Q: "ŸÑ€åŸÜ⁄© ÿßÿ¥ÿ™ÿ±ÿß⁄© ⁄Ü€åÿ≥ÿ™ÿü",
                faq1A: "ŸÑ€åŸÜ⁄© ÿßÿ¥ÿ™ÿ±ÿß⁄© ÿ¥ÿßŸÖŸÑ ÿ™ŸÖÿßŸÖ ÿ™ŸÜÿ∏€åŸÖÿßÿ™ ÿ≥ÿ±Ÿàÿ± ÿ¥ŸÖÿßÿ≥ÿ™. ŸàŸÇÿ™€å ÿ¢ŸÜ ÿ±ÿß ÿ®Ÿá ÿ®ÿ±ŸÜÿßŸÖŸá VPN ÿßÿ∂ÿßŸÅŸá ŸÖ€å‚Äå⁄©ŸÜ€åÿØÿå ÿ™ŸÖÿßŸÖ ÿ≥ÿ±Ÿàÿ±Ÿáÿß ÿ®Ÿá ÿµŸàÿ±ÿ™ ÿÆŸàÿØ⁄©ÿßÿ± ÿØÿßŸÜŸÑŸàÿØ ŸÖ€å‚Äåÿ¥ŸàŸÜÿØ.",
                faq2Q: "⁄Ü⁄ØŸàŸÜŸá ÿ≥ÿ±Ÿàÿ±Ÿáÿß ÿ±ÿß ÿ¢ŸæÿØ€åÿ™ ⁄©ŸÜŸÖÿü",
                faq2A: "ÿß⁄©ÿ´ÿ± ÿ®ÿ±ŸÜÿßŸÖŸá‚ÄåŸáÿß ÿØ⁄©ŸÖŸá ¬´ÿ¢ŸæÿØ€åÿ™ ÿßÿ¥ÿ™ÿ±ÿß⁄©¬ª ÿØÿßÿ±ŸÜÿØ. ÿ®ÿ±ÿß€å ÿØÿ±€åÿßŸÅÿ™ ÿ¢ÿÆÿ±€åŸÜ ÿ™ŸÜÿ∏€åŸÖÿßÿ™ ÿ¢ŸÜ ÿ±ÿß ⁄©ŸÑ€å⁄© ⁄©ŸÜ€åÿØ.",
                faq3Q: "⁄©ÿØÿßŸÖ ÿ≥ÿ±Ÿàÿ± ÿ±ÿß ÿßŸÜÿ™ÿÆÿßÿ® ⁄©ŸÜŸÖÿü",
                faq3A: "ÿ≥ÿ±Ÿàÿ±€å ⁄©Ÿá ÿ®Ÿá ŸÖŸàŸÇÿπ€åÿ™ ÿ¥ŸÖÿß ŸÜÿ≤ÿØ€å⁄©‚Äåÿ™ÿ± ÿßÿ≥ÿ™ ÿ±ÿß ÿßŸÜÿ™ÿÆÿßÿ® ⁄©ŸÜ€åÿØ. ÿß⁄Øÿ± ⁄©ÿßÿ± ŸÜ⁄©ÿ±ÿØÿå ÿ≥ÿ±Ÿàÿ± ÿØ€å⁄Øÿ±€å ÿ±ÿß ÿßŸÖÿ™ÿ≠ÿßŸÜ ⁄©ŸÜ€åÿØ. ÿ≥ÿ±Ÿàÿ±Ÿáÿß€å Reality €åÿß TLS Ÿæÿß€åÿØÿßÿ±ÿ™ÿ±ŸÜÿØ.",
                faq4Q: "ÿß⁄Øÿ± ŸÖÿ™ÿµŸÑ ŸÜÿ¥ÿØ ⁄ÜŸá ⁄©ÿßÿ± ⁄©ŸÜŸÖÿü",
                faq4A: "ÿß€åŸÜ ŸÖÿ±ÿßÿ≠ŸÑ ÿ±ÿß ÿßŸÖÿ™ÿ≠ÿßŸÜ ⁄©ŸÜ€åÿØ: €±) ÿ≥ÿ±Ÿàÿ± ÿØ€å⁄Øÿ±€å ÿßŸÜÿ™ÿÆÿßÿ® ⁄©ŸÜ€åÿØÿå €≤) ÿßÿ¥ÿ™ÿ±ÿß⁄© ÿ±ÿß ÿ¢ŸæÿØ€åÿ™ ⁄©ŸÜ€åÿØÿå €≥) ÿ®ÿ±ŸÜÿßŸÖŸá ÿ±ÿß ÿ±€åÿ≥ÿ™ÿßÿ±ÿ™ ⁄©ŸÜ€åÿØÿå €¥) ÿßÿ™ÿµÿßŸÑ ÿß€åŸÜÿ™ÿ±ŸÜÿ™ ÿ±ÿß ÿ®ÿ±ÿ±ÿ≥€å ⁄©ŸÜ€åÿØ.",
                faq5Q: "⁄ÜŸÇÿØÿ± ÿ≠ÿ¨ŸÖ ÿØÿßÿ±ŸÖÿü",
                faq5A: "ÿ≠ÿ¨ŸÖ ŸÖÿµÿ±ŸÅ€å ÿ¥ŸÖÿß ÿØÿ± ⁄©ÿßÿ±ÿ™ ¬´ŸÖÿµÿ±ŸÅ ÿ¥ÿØŸá¬ª ÿ®ÿßŸÑÿß€å ÿµŸÅÿ≠Ÿá ŸÜŸÖÿß€åÿ¥ ÿØÿßÿØŸá ŸÖ€å‚Äåÿ¥ŸàÿØ. Ÿæÿ≥ ÿßÿ≤ ÿßÿ™ŸÖÿßŸÖ ÿ≠ÿ¨ŸÖÿå ÿßÿ™ÿµÿßŸÑ ŸÖÿ™ŸàŸÇŸÅ ŸÖ€å‚Äåÿ¥ŸàÿØ.",
                supportTitle: "ŸÜ€åÿßÿ≤ ÿ®Ÿá ⁄©ŸÖ⁄© ÿØÿßÿ±€åÿØÿü",
                supportDesc: "ŸÖÿß €≤€¥ ÿ≥ÿßÿπÿ™Ÿá ÿØÿ± ÿÆÿØŸÖÿ™ ÿ¥ŸÖÿß Ÿáÿ≥ÿ™€åŸÖ",
                telegramDesc: "Ÿæÿßÿ≥ÿÆ ÿ≥ÿ±€åÿπ ÿØÿ± ÿ™ŸÑ⁄Øÿ±ÿßŸÖ",
                emailDesc: "ÿß€åŸÖ€åŸÑ ÿ®ŸÅÿ±ÿ≥ÿ™€åÿØ",
                ticketTitle: "ÿßÿ±ÿ≥ÿßŸÑ ÿ™€å⁄©ÿ™",
                ticketDesc: "€å⁄© ÿ™€å⁄©ÿ™ Ÿæÿ¥ÿ™€åÿ®ÿßŸÜ€å ÿß€åÿ¨ÿßÿØ ⁄©ŸÜ€åÿØ"
            }
        };

        let currentLang = 'en';
        let allConfigs = [];
        let filteredConfigs = [];
        let activeCountryFilter = 'all';
        let activeProtocolFilter = 'all';

        // Parse subscription URL
        function parseSubscriptionUrl() {
            const path = window.location.pathname;
            const token = path.split('/').pop();

            try {
                const decoded = atob(token);
                const [username, timestamp] = decoded.split(',');
                return { username, timestamp: parseInt(timestamp) };
            } catch (e) {
                console.error('Failed to parse token:', e);
                return { username: 'User', timestamp: Date.now() / 1000 };
            }
        }

        // Fetch subscription data
        async function fetchSubscription() {
            try {
                const response = await fetch(window.location.href);
                const base64Data = await response.text();
                const decoded = atob(base64Data);
                const configs = decoded.split('\n').filter(line => line.trim());
                return configs;
            } catch (e) {
                console.error('Failed to fetch subscription:', e);
                return [];
            }
        }

        // Parse config line
        function parseConfig(line) {
            try {
                const [protocol, rest] = line.split('://');
                const [connection, nameEncoded] = rest.split('#');
                const name = decodeURIComponent(nameEncoded);

                // Extract country from emoji or name
                const countryMap = {
                    'üá∫üá∏': 'USA',
                    'üá©üá™': 'Germany',
                    'üá≥üá±': 'Netherlands',
                    'üá¨üáß': 'England'
                };

                let country = 'Unknown';
                let flag = 'üåê';

                for (const [emoji, countryName] of Object.entries(countryMap)) {
                    if (name.includes(emoji)) {
                        country = countryName;
                        flag = emoji;
                        break;
                    }
                }

                // Extract type from params
                let type = protocol.toUpperCase();
                if (line.includes('reality')) type += ' ‚Ä¢ Reality';
                else if (line.includes('tls')) type += ' ‚Ä¢ TLS';

                return {
                    raw: line,
                    protocol: protocol.toUpperCase(),
                    name: name.replace(/üá∫üá∏|üá©üá™|üá≥üá±|üá¨üáß/g, '').trim(),
                    country,
                    flag,
                    type
                };
            } catch (e) {
                console.error('Failed to parse config:', e);
                return null;
            }
        }

        // Render server card
        function renderServerCard(config) {
            return `
                <div class="server-card" data-country="${config.country}" data-protocol="${config.protocol}">
                    <div class="server-header">
                        <div class="server-flag">${config.flag}</div>
                        <div class="server-info">
                            <h3 class="server-name">${config.name}</h3>
                            <div class="server-meta">
                                <span class="badge protocol">${config.protocol}</span>
                                ${config.type.includes('Reality') ? '<span class="badge">Reality</span>' : ''}
                                ${config.type.includes('TLS') ? '<span class="badge">TLS</span>' : ''}
                            </div>
                        </div>
                    </div>
                    <div class="server-actions">
                        <button class="btn-small" onclick='copyConfig(\`${config.raw.replace(/`/g, '\\`')}\`)'>
                            <i class="ri-file-copy-line"></i>
                            <span data-i18n="copy">Copy</span>
                        </button>
                        <button class="btn-small" onclick='showQR(\`${config.raw.replace(/`/g, '\\`')}\`)'>
                            <i class="ri-qr-code-line"></i>
                            <span data-i18n="qr">QR</span>
                        </button>
                    </div>
                </div>
            `;
        }

        // Render servers
        function renderServers() {
            const container = document.getElementById('servers-list');
            container.innerHTML = filteredConfigs.map(renderServerCard).join('');
            document.getElementById('server-count').textContent = filteredConfigs.length;
            applyLanguage();
        }

        // Filter servers
        function filterServers() {
            filteredConfigs = allConfigs.filter(config => {
                const countryMatch = activeCountryFilter === 'all' || config.country === activeCountryFilter;
                const protocolMatch = activeProtocolFilter === 'all' || config.protocol === activeProtocolFilter;
                return countryMatch && protocolMatch;
            });
            renderServers();
        }

        // Render filters
        function renderFilters() {
            // Country filters
            const countries = ['all', ...new Set(allConfigs.map(c => c.country))];
            const countryContainer = document.getElementById('country-filters');
            countryContainer.innerHTML = countries.map(country =>
                `<div class="chip ${country === activeCountryFilter ? 'active' : ''}" onclick="setCountryFilter('${country}')">
                    ${country === 'all' ? translations[currentLang].all : country}
                </div>`
            ).join('');

            // Protocol filters
            const protocols = ['all', ...new Set(allConfigs.map(c => c.protocol))];
            const protocolContainer = document.getElementById('protocol-filters');
            protocolContainer.innerHTML = protocols.map(protocol =>
                `<div class="chip ${protocol === activeProtocolFilter ? 'active' : ''}" onclick="setProtocolFilter('${protocol}')">
                    ${protocol === 'all' ? translations[currentLang].all : protocol}
                </div>`
            ).join('');
        }

        // Set filters
        function setCountryFilter(country) {
            activeCountryFilter = country;
            renderFilters();
            filterServers();
        }

        function setProtocolFilter(protocol) {
            activeProtocolFilter = protocol;
            renderFilters();
            filterServers();
        }

        // Copy config
        function copyConfig(config) {
            navigator.clipboard.writeText(config).then(() => {
                showToast(translations[currentLang].copied);
            });
        }

        // Copy all configs
        function copyAllConfigs() {
            const allText = allConfigs.map(c => c.raw).join('\n');
            navigator.clipboard.writeText(allText).then(() => {
                showToast(translations[currentLang].copied);
            });
        }

        // Show QR
        function showQR(config) {
            // Create modal with QR code
            const modal = document.createElement('div');
            modal.style.cssText = 'position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,0.9);display:flex;align-items:center;justify-content:center;z-index:9999;';
            modal.innerHTML = '<div id="qr-container" style="background:white;padding:2rem;border-radius:12px;"></div>';
            modal.onclick = () => modal.remove();
            document.body.appendChild(modal);

            new QRCode(document.getElementById('qr-container'), {
                text: config,
                width: 256,
                height: 256
            });
        }

        // Download QR
        function downloadQR() {
            showToast('QR Code download feature coming soon!');
        }

        // Quick actions
        function importAll() {
            showToast('Import all feature coming soon!');
        }

        function downloadAll() {
            const blob = new Blob([allConfigs.map(c => c.raw).join('\n')], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'configs.txt';
            a.click();
        }

        function testSpeed() {
            showToast('Speed test feature coming soon!');
        }

        function getSupport() {
            showToast('Support feature coming soon!');
        }

        // Show toast
        function showToast(message) {
            const toast = document.getElementById('toast');
            document.getElementById('toast-message').textContent = message;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        }

        // Toggle language
        function toggleLanguage() {
            currentLang = currentLang === 'en' ? 'fa' : 'en';
            document.documentElement.dir = currentLang === 'fa' ? 'rtl' : 'ltr';
            document.getElementById('lang-icon').textContent = currentLang.toUpperCase();
            applyLanguage();
            renderFilters();
        }

        // Apply language
        function applyLanguage() {
            document.querySelectorAll('[data-i18n]').forEach(el => {
                const key = el.getAttribute('data-i18n');
                if (translations[currentLang][key]) {
                    el.textContent = translations[currentLang][key];
                }
            });
        }

        // Initialize
        async function init() {
            const { username, timestamp } = parseSubscriptionUrl();
            document.getElementById('username').textContent = username;

            // Calculate expiry
            const now = Math.floor(Date.now() / 1000);
            const daysLeft = Math.ceil((timestamp - now) / 86400);
            const expireDate = new Date(timestamp * 1000).toLocaleDateString();

            document.getElementById('expire-date').textContent = expireDate;
            document.getElementById('days-left').textContent = daysLeft > 0 ? daysLeft : 0;

            // Set status
            if (daysLeft <= 0) {
                document.getElementById('status-badge').classList.remove('active');
                document.getElementById('status-badge').classList.add('expired');
                document.getElementById('status-text').textContent = translations[currentLang].expired;
            }

            // Fetch configs
            const configs = await fetchSubscription();
            allConfigs = configs.map(parseConfig).filter(c => c !== null);
            filteredConfigs = [...allConfigs];

            // Mock traffic data (you can replace with real data)
            const usedGB = 1.35;
            const totalGB = 1.42;
            const percent = (usedGB / totalGB * 100).toFixed(1);

            document.getElementById('used-traffic').textContent = usedGB.toFixed(2) + ' TB';
            document.getElementById('total-traffic').textContent = totalGB.toFixed(2) + ' TB';
            document.getElementById('traffic-progress').style.width = percent + '%';

            // Render
            renderFilters();
            renderServers();

            // Hide loading, show content
            document.getElementById('loading').style.display = 'none';
            document.getElementById('content').style.display = 'block';
        }

        // Run
        init();

        // FAQ Toggle
        function toggleFaq(element) {
            element.classList.toggle('open');
        }

        // Show Ticket Form
        function showTicketForm() {
            showToast('Ticket system coming soon!');
        }
    </script>
</body>

</html>